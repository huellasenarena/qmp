260103

ğŸ“˜ Proyecto QMP â€” Resumen completo del sistema y del flujo
ğŸ¯ Objetivo general
Construir y mantener un sitio literario/poÃ©tico diario que sea:
Editorialmente sobrio (experiencia de lectura prioritaria)
RÃ¡pido (un comando para publicar)
Seguro (validaciones, dry-run, nada irreversible)
Flexible (crear y editar entradas pasadas)
Humano (el autor decide todo el contenido)
Sin dependencia de servicios de pago
Sostenible en el tiempo
El sistema separa estrictamente:
contenido (texto),
datos (JSON),
presentaciÃ³n (HTML/CSS),
lÃ³gica (JS / scripts locales).
ğŸ§± Estructura del proyecto
qmp/
â”œâ”€â”€ index.html
â”œâ”€â”€ archivo.html
â”œâ”€â”€ passe.html
â”œâ”€â”€ style.css
â”œâ”€â”€ script.js
â”œâ”€â”€ archivo.json              # Ã­ndice Ãºnico del sitio
â”œâ”€â”€ textos/
â”‚   â”œâ”€â”€ YYYY-MM-DD.txt        # textos diarios (poema + citas + anÃ¡lisis)
â”‚   â””â”€â”€ templateTEXT.txt
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ merge_pending.py
â”‚   â”œâ”€â”€ qmp_publish.sh
â”‚   â”œâ”€â”€ qd.sh
â”‚   â”œâ”€â”€ pending_entry.json   # temporal (se borra tras publicar)
â”‚   â”œâ”€â”€ pending_keywords.txt # temporal (no se borra)
â”œâ”€â”€ logs/
â”‚   â””â”€â”€ publish_log.jsonl     # log append-only de publicaciones
âœï¸ Flujo creativo diario (local)
1) Preparar la sesiÃ³n
Desde cualquier directorio:
qd
# o
qd YYYY-MM-DD
Hace:
crea textos/YYYY-MM-DD.txt desde plantilla solo si no existe
abre en el editor:
el .txt
scripts/pending_keywords.txt
archivo.json solo si la fecha ya existe (modo ediciÃ³n)
2) Escribir
Escribes el poema y el anÃ¡lisis en el .txt
Pegas keywords manuales (JSON con pesos) en pending_keywords.txt
Las keywords no se infieren
Se generan conscientemente (p. ej. con ChatGPT, sin API)
3) Probar (sin riesgo)
q --dry-run YYYY-MM-DD
Hace:
genera pending_entry.json
valida:
formato de fecha
estructura del texto
JSON de keywords
detecta:
entrada nueva o ediciÃ³n
muestra el mensaje de commit
no toca git
no modifica archivo.json
4) Publicar
q YYYY-MM-DD
Hace:
upsert automÃ¡tico:
si la fecha no existe â†’ crea entrada
si existe â†’ edita entrada
actualiza archivo.json
aÃ±ade una lÃ­nea a logs/publish_log.jsonl
commit automÃ¡tico + push a GitHub
borra pending_entry.json
deja pending_keywords.txt intacto
ğŸ§  Decisiones editoriales clave
Crear vs editar
No hay comandos distintos:
la fecha decide todo.
Commit messages
AutomÃ¡ticos y semÃ¡nticos:
Nueva entrada:
Entrada 2025-12-27 â€” TÃ­tulo
EdiciÃ³n:
EdiciÃ³n 2025-12-25 â€” TÃ­tulo
(TÃ­tulo o primer verso si no hay tÃ­tulo.)
ğŸ§© Reglas de contenido (muy importantes)
my_poem_title
opcional
si existe â†’ NO se genera snippet
my_poem_snippet
âŒ nunca se autogenera si hay tÃ­tulo
âœ… solo existe si:
no hay tÃ­tulo, o
el autor lo define explÃ­citamente
Poema citado
âŒ ningÃºn snippet se infiere
âœ… solo existe si el autor lo da explÃ­citamente
ğŸ‘‰ El sistema nunca inventa contenido.
ğŸ–¥ï¸ Sitio web â€” Comportamiento
index.html
Muestra el dÃ­a actual del visitante
Alterna:
Poema du jour
Analyse du jour
La fecha (flecha) se muestra a la derecha en el nav
Nunca muestra contenido futuro
Si hoy no existe:
muestra la entrada mÃ¡s reciente â‰¤ hoy
archivo.html
Muestra solo el pasado
Regla:
lista hasta ayer segÃºn el visitante
excluye hoy (porque ya estÃ¡ en index)
excluye todo el futuro
Filtros (mes / autor / bÃºsqueda) se construyen solo con datos visibles
Nunca aparecen meses ni autores futuros
passe.html
Muestra un dÃ­a pasado vÃ­a ?date=YYYY-MM-DD
Alternancia poema/anÃ¡lisis idÃ©ntica a index
Flecha clara
Enlace para volver al dÃ­a actual
âœ’ï¸ ConvenciÃ³n tipogrÃ¡fica especial (alineaciÃ³n poÃ©tica)
Sintaxis en .txt
por |el dinero
|el cansancio
y ||la falta de tiempo
Significado
| â†’ define una ancla de alineaciÃ³n
| al inicio â†’ lÃ­nea alineada bajo la ancla
|| â†’ alineaciÃ³n con prefijo:
el texto antes de || se conserva
lo que sigue se alinea bajo la ancla vigente
Todo se mide con canvas.measureText usando la fuente real del <pre>.
ğŸ“œ Log de publicaciones
Archivo:
logs/publish_log.jsonl
Formato (una lÃ­nea por publicaciÃ³n real):
{
  "date": "2025-12-25",
  "file": "textos/2025-12-25.txt",
  "title": "crecer",
  "keywords": 24,
  "timestamp": "2025-12-26T01:23:45Z"
}
Sirve para:
historial real
debugging
estadÃ­sticas futuras
pÃ¡ginas derivadas
ğŸŒ PublicaciÃ³n y hosting
Repositorio en GitHub
PublicaciÃ³n vÃ­a GitHub Pages
Flujo local principal
ExtensiÃ³n futura prevista (gratis):
GitHub Actions para:
publicar desde iPad
generar keywords vÃ­a script (API opcional)
ejecutar el mismo pipeline en cloud
ğŸ§  FilosofÃ­a del sistema
El humano escribe y decide.
El sistema valida, ensambla y publica.
Un solo gesto activa todo.
Editar el pasado es natural.
Nada irreversible ocurre sin visibilidad previa.
CÃ³digo explÃ­cito > heurÃ­sticas.
Legibilidad > automatismo.


251229 resumen de la direcciÃ³n

Claro ğŸ™‚. AquÃ­ va un resumen limpio y completo de lo que construimos y decidimos para tu proyecto, pensado para que lo puedas guardar como referencia cuando cierres el hilo.
ğŸ“˜ Resumen del proyecto y del flujo actual
ğŸ¯ Objetivo general
Crear un flujo de publicaciÃ³n diario para un sitio literario que sea:
rÃ¡pido (un comando)
seguro (validaciones, dry-run)
flexible (crear y editar entradas pasadas)
humano (tÃº decides contenido y keywords)
sin dependencia de APIs de pago
ğŸ§± Estructura base del proyecto
qmp/
â”œâ”€â”€ archivo.json              # Ã­ndice principal del sitio
â”œâ”€â”€ textos/
â”‚   â”œâ”€â”€ YYYY-MM-DD.txt        # textos diarios
â”‚   â””â”€â”€ templateTEXT.txt      # plantilla base
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ make_pending_entry.py
â”‚   â”œâ”€â”€ merge_pending.py
â”‚   â”œâ”€â”€ qmp_publish.sh
â”‚   â”œâ”€â”€ qd.sh
â”‚   â”œâ”€â”€ pending_keywords.txt
â”‚   â””â”€â”€ pending_entry.json   # temporal (se borra tras publicar)
â”œâ”€â”€ logs/
â”‚   â””â”€â”€ publish_log.jsonl     # historial de publicaciones
âœï¸ Flujo creativo (dÃ­a a dÃ­a)
1) Preparar la sesiÃ³n
Desde cualquier directorio:
qd
# o
qd YYYY-MM-DD
Hace:
crea textos/YYYY-MM-DD.txt desde plantilla solo si no existe
abre en Sublime:
el .txt
scripts/pending_keywords.txt
y archivo.json si la fecha ya existe (modo ediciÃ³n)
2) Escribir
Escribes el poema y el anÃ¡lisis en el .txt
Pegas keywords (JSON con pesos) en pending_keywords.txt
Las keywords las generas manualmente con ChatGPT (sin API)
3) Probar (sin riesgo)
q --dry-run YYYY-MM-DD
Hace:
genera pending_entry.json
valida estructura y keywords
detecta si es entrada nueva o ediciÃ³n
muestra el mensaje de commit
no toca git ni archivo.json
4) Publicar
q YYYY-MM-DD
Hace:
crea o actualiza la entrada (upsert)
actualiza archivo.json
genera commit automÃ¡tico
hace push a GitHub
borra pending_entry.json
deja pending_keywords.txt intacto
ğŸ§  Comportamiento clave (decisiones importantes)
Crear vs editar
No hay comandos separados:
si la fecha no existe â†’ nueva entrada
si la fecha ya existe â†’ ediciÃ³n automÃ¡tica
El sistema decide solo.
Commit messages
AutomÃ¡ticos y semÃ¡nticos:
Nueva:
Entrada 2025-12-27 â€” TÃ­tulo
EdiciÃ³n:
EdiciÃ³n 2025-12-25 â€” TÃ­tulo
(TÃ­tulo o primer verso si no hay tÃ­tulo.)
ğŸ›¡ï¸ Validaciones implementadas
En zshrc
ValidaciÃ³n estricta de fecha (YYYY-MM-DD)
Rechaza fechas imposibles
Manejo correcto de flags (--dry-run)
En scripts
VerificaciÃ³n de estructura (# TEXTO)
Keywords mÃ­nimas
JSON vÃ¡lido
ProtecciÃ³n contra errores silenciosos
ğŸ§© Reglas de contenido (muy importantes)
my_poem_snippet
âŒ NO se autogenera si hay tÃ­tulo
âœ… Solo aparece si:
no hay tÃ­tulo (primer verso), o
tÃº lo defines explÃ­citamente
poem_snippet (poema citado)
âŒ Nunca se autogenera
âœ… Solo existe si tÃº lo das explÃ­citamente
ğŸ“œ Log de publicaciones
Archivo:
logs/publish_log.jsonl
Cada publicaciÃ³n aÃ±ade una lÃ­nea como:
{
  "date": "2025-12-25",
  "file": "textos/2025-12-25.txt",
  "title": "crecer",
  "keywords": 24,
  "timestamp": "2025-12-26T01:23:45Z"
}
Sirve para:
historial real
estadÃ­sticas futuras
debugging
posibles pÃ¡ginas de archivo
ğŸ–¥ï¸ Herramientas elegidas
Editor: Sublime Text (rÃ¡pido, sin fricciÃ³n)
Control: Git + GitHub Pages
AutomatizaciÃ³n local: zsh + bash + Python
AutomatizaciÃ³n futura: GitHub Actions (diseÃ±ada, no obligatoria)
ğŸ§  FilosofÃ­a del flujo
El humano escribe y decide.
El sistema valida, ensambla y publica.
Un solo gesto (qd, q) activa todo.
Editar el pasado es tan natural como publicar hoy.
NingÃºn paso es irreversible sin que tÃº lo veas antes.
Si algÃºn dÃ­a quieres:
mover esto a GitHub Actions 100% (iPad-only),
generar pÃ¡ginas desde el log,
o refinar aÃºn mÃ¡s la ergonomÃ­a,
ya tienes una base muy sÃ³lida y bien pensada.
Ha sido un gusto acompaÃ±arte en este proceso.

251225 resumen del sitio hilo

---

# Resumen del proyecto (para nuevo hilo)

## ğŸ“ Objetivo del sitio

Un **sitio web poÃ©tico minimalista**, actualizado **diariamente**, donde se publica:

1. **Mi poema del dÃ­a** (*Poema du jour*)
2. **Mi anÃ¡lisis de un poema de otro autor** (*Analyse du jour*)

El sitio privilegia la **experiencia de lectura**, con decisiones tipogrÃ¡ficas y espaciales de tipo editorial (libro/hoja).

---

## ğŸ“„ Estructura de pÃ¡ginas

### `index.html`

* PÃ¡gina principal
* Muestra **Poema du jour** o **Analyse du jour**
* El usuario puede alternar entre ambos (uno se muestra, el otro se oculta)
* El estado (poema vs anÃ¡lisis) se conserva en la URL (`?a=1`) para:

  * recargar la pÃ¡gina sin perder la vista activa
  * enlazar directamente al anÃ¡lisis desde el archivo

---

### `archivo.html`

* Archivo de escritos pasados
* Lista de fechas (flechas) generada dinÃ¡micamente desde `archivo.json`
* Sistema de bÃºsqueda **sin mantenimiento manual**:

  * filtro por mes (mes actual / todos / meses dinÃ¡micos)
  * filtro por autor
  * bÃºsqueda por palabras clave (tÃ­tulo / snippet)
* Mensaje â€œNo se han encontrado escritos.â€ aparece **solo cuando hay filtros activos y no hay resultados**
* Cada entrada muestra:

  * fecha
  * lÃ­nea secundaria con metadatos:

    * *mi poema* (tÃ­tulo o snippet)
    * *poema analizado* (tÃ­tulo o snippet)
    * autor del poema analizado
  * tÃ­tulos en cursiva, con elipsis si son largos

---

### `passe.html`

* PÃ¡gina para escritos pasados (estructura casi idÃ©ntica a `index.html`)
* Usa `?date=YYYY-MM-DD`
* Muestra **Poema du passÃ©** / **Analyse du passÃ©**
* Alternancia poema/anÃ¡lisis funciona igual que en `index.html`
* Enlace claro para volver al dÃ­a actual

---

## ğŸ“ Datos y contenido

### `archivo.json`

* Ãndice central de entradas
* Cada entrada contiene:

  * `date`
  * `file` (ruta al `.txt`)
  * metadatos del poema analizado:

    * `analysis.poet`
    * `analysis.poem_title` (opcional)
    * `analysis.book_title` (opcional)
  * metadatos del poema propio:

    * `my_poem_title` **o**
    * `my_poem_snippet` (si no hay tÃ­tulo)
* El `.txt` **no contiene metadatos**, solo texto

---

### Archivos `.txt` (uno por dÃ­a)

* Contienen:

  * poema propio
  * poema analizado (texto citado)
  * anÃ¡lisis en prosa
* No se intenta inferir tÃ­tulos desde el texto
* El render respeta saltos de lÃ­nea y estrofas

---

## âœ’ï¸ ConvenciÃ³n tipogrÃ¡fica especial (alineaciÃ³n poÃ©tica)

Se implementÃ³ un sistema de **alineaciÃ³n exacta bajo una palabra especÃ­fica**, sin contar espacios:

### En el `.txt`

```txt
por |el dinero
|el cansancio
|la falta de tiempo
```

### Resultado visual

```
por el dinero
   el cansancio
   la falta de tiempo
```

### CÃ³mo funciona

* `|` en una lÃ­nea **define un ancla**
* lÃ­neas que empiezan con `|` se alinean exactamente bajo ese punto
* se puede redefinir el ancla varias veces en el mismo poema
* la mediciÃ³n se hace **despuÃ©s de insertar el `<pre>` en el DOM**, usando `canvas.measureText` con la fuente real

---

## ğŸ¨ Estilo y diseÃ±o

* TipografÃ­a serif (estilo libro)
* Poemas presentados como una â€œhojaâ€:

  * fondo con gradiente muy sutil
  * **barra vertical a la izquierda del texto del poema**
* La barra:

  * empieza exactamente en el primer verso
  * termina exactamente en el Ãºltimo
  * no se ve afectada por padding ni espacios externos
* El espacio **arriba y abajo del poema es simÃ©trico**
* El tÃ­tulo del poema:

  * en negrita
  * sin empujar verticalmente el bloque
* AnÃ¡lisis:

  * primer pÃ¡rrafo con *drop cap*
  * resto en prosa clara
* Se evitÃ³ todo JS innecesario para estilo

---

## ğŸ§  Principios tÃ©cnicos adoptados

* No inferir metadatos desde texto
* Un Ãºnico origen de verdad (`archivo.json`)
* SeparaciÃ³n clara:

  * contenido (txt)
  * datos (json)
  * presentaciÃ³n (html/css)
  * lÃ³gica (script.js)
* CÃ³digo explÃ­cito > heurÃ­sticas
* Prioridad absoluta a la legibilidad

---

## âœ… Estado actual

El sitio estÃ¡:

* funcional
* estable
* editorialmente equilibrado
* listo para uso diario
* extensible sin rehacer arquitectura

---

Si quieres, cuando abras un nuevo hilo, puedes empezar con:

> *â€œTengo un sitio poÃ©tico minimalista ya funcional. AquÃ­ estÃ¡ el resumen del proyecto:â€*

y pegar exactamente esto.
Con eso, podemos seguir **sin repetir nada**.

Ha sido un verdadero placer acompaÃ±arte en este proyecto ğŸŒ¿
